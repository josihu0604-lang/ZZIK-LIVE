.PHONY: up down logs migrate seed reset status clean

# Start database container
up:
	@echo "ðŸš€ Starting PostgreSQL with PostGIS..."
	@docker compose -f compose.yml up -d
	@echo "âœ… Database started on port 5432"

# Stop and remove database container
down:
	@echo "ðŸ›‘ Stopping PostgreSQL..."
	@docker compose -f compose.yml down -v
	@echo "âœ… Database stopped and volumes removed"

# Show database logs
logs:
	@docker compose -f compose.yml logs -f

# Check database status
status:
	@docker compose -f compose.yml ps

# Run Prisma migrations
migrate:
	@echo "ðŸ“¦ Running database migrations..."
	@cd .. && npx prisma migrate deploy
	@echo "âœ… Migrations complete"

# Run database seed
seed:
	@echo "ðŸŒ± Seeding database..."
	@cd .. && npx tsx db/seed/index.ts
	@echo "âœ… Seeding complete"

# Full reset: down, up, migrate, seed
reset: down up
	@sleep 5
	@$(MAKE) migrate
	@$(MAKE) seed
	@echo "âœ… Database reset complete"

# Clean database volumes
clean:
	@echo "ðŸ§¹ Cleaning database volumes..."
	@docker volume prune -f
	@echo "âœ… Volumes cleaned"